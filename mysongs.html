<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>VibeZ : My Songs</title>
    <link rel="stylesheet" href="FinalProject.css">
    <script src="finalProject.js"></script>
</head>
<body>
    <!-- Top part of each page, includes logo and top navigation -->
    <div id="header">
        <div id="logo">
            <a href="index.html"><img src="images/VibeZ.png"></a>
            <button id='signOut' class="toggleButton" style="position: absolute; top: 10px; right: 10px;">Sign Out</button>
        </div>
        <div id="topnav">
            <a href="index.html">Home</a>
            <a href="mysongs.html" class="active"> My Songs </a>
            <a href="browse.html"> Browse All </a>
            <a href="speedsearch.html"> Speed Search </a>
        </div>
    </div>
        <div class="content">
            <h2> My Songs </h2>
            <hr class="songs">
            <div id="emptyMessage"></div>
            <div class="songGrid" id="songGrid2"></div>
        </div>
    
<script>
    document.getElementById('signOut').addEventListener('click', function(event) {
        localStorage.removeItem('token');  
        window.location.href = "login.html";       
    });
    
    const token = localStorage.getItem('token');

    console.log(token);

    res = fetch('https://cs120-final-project.vercel.app/api/songs', {
        method: 'GET',
        headers: {
            Authorization: `Bearer ${token}`
        },
    })
    .then(response => response.json())
    .then(data => { 
        let parsedData = data;
        if (data.count == 0){
            document.getElementById("emptyMessage").insertAdjacentHTML("beforeend", "<p>Head over to <a href='browse.html'> BROWSE </a> or <a href='speedsearch.html'> SPEED SEARCH </a> to add some songs!</p>");
        }
        console.log(parsedData)
        parsedData.data.forEach(song => {
            id = String(song._id);
            document.getElementById("songGrid2").insertAdjacentHTML("beforeend", "<div class='songCard1'> <img src=' " + song.cover + "'> <h3>" + song.title + "</h3> <p>" + song.artist + ", " + song.published + "</p><p>Rating: " + song.rating + 
                "</p><button id='dislikeButton' onclick='removeSong(\"" + id + "\");'> REMOVE </button></div>")
        });
    })
    .catch(error => {
        console.log(error);
    });            
</script>
</body>
</html>
